{#
| Variable         | Type    | Description                     |
|------------------|---------|---------------------------------|
| cart             | object  |                                 |
| cart.items_count | int     |                                 |
| cart.total       | string  | Formatted total ex: "١٠٠ ر.س"   |
#}
{% set important_links = theme.settings.get('important_links') %}
<header class="store-header" style="position: relative; z-index: 1000; background-color: #000000;">
  {# Top Nav #}
  <div class="top-navbar text-white" style="background-color: #000000; min-height: 60px; display: flex; align-items: center;">
    <div class="container flex justify-between items-center py-3 px-4 md:px-8 lg:px-20">
     
      {# Left side - Cart #}
      <div class="flex items-center gap-4">
          <img 
            src="{{ 'images/icons/bitcoin-icons_cart-outline.png'|asset }}" 
            alt="Cart" 
            class="w-6 h-6 cursor-pointer hover:opacity-80 transition-opacity"
            onclick="salla.event.dispatch('cart::open')"
          />
      </div>
      
      {# Center - Logo #}
      <div class="flex items-center">
          <a class="navbar-brand" href="{{ store.url }}">
              <img 
                src="{{ 'images/logo.png'|asset }}" 
                alt="{{ store.name }} logo" 
                class="w-[132px] h-[26px] flex-shrink-0 object-contain"
                style="aspect-ratio: 66/13;"
              >
              {% if is_page('index') %}
                <h1 class="sr-only">{{ store.name }}</h1>
              {% else %}
                <h2 class="sr-only">{{ store.name }}</h2>
              {% endif %}
          </a>
      </div>
      
      {# Right side - Language #}
      <div class="flex items-center gap-2">
          {% if store.settings.is_multilingual or store.settings.currencies_enabled %}
          <span class="text-white font-comfortaa text-[12px] font-normal leading-[25px]">
              {{ user.language.code == 'ar' ? 'En' : 'Ar' }}
          </span>
          <img 
            src="{{ 'images/icons/material-symbols-light_language.png'|asset }}" 
            alt="Language" 
            class="w-5 h-5 cursor-pointer hover:opacity-80 transition-opacity"
            onclick="toggleLanguageDropdown()"
          />
          
          <div id="language-dropdown" class="absolute top-full ltr:right-0 rtl:left-0 mt-1 w-40 rounded-md shadow-xl border border-gray-400 z-[9999] hidden" style="background-color: #000000;">
              <div class="py-1">
                  <a href="#" onclick="changeLanguage('en')" class="flex items-center justify-between px-3 py-2 text-sm text-white hover:bg-gray-800 transition-colors duration-150">
                      <div class="flex items-center">
                          <span class="flag iti__flag iti__us rounded-sm ltr:mr-2 rtl:ml-2"></span>
                          <span>English</span>
                      </div>
                      <span class="text-gray-300 text-xs">EN</span>
                  </a>
                  <a href="#" onclick="changeLanguage('ar')" class="flex items-center justify-between px-3 py-2 text-sm text-white hover:bg-gray-800 transition-colors duration-150">
                      <div class="flex items-center">
                          <span class="flag iti__flag iti__sa rounded-sm ltr:mr-2 rtl:ml-2"></span>
                          <span>العربية</span>
                      </div>
                      <span class="text-gray-300 text-xs">AR</span>
                  </a>
              </div>
          </div>
          {% endif %}
      </div>
    </div>
  </div>

  {# Main Nav #}
  <div id="mainnav" class="main-nav-container shadow-default bg-black" style="min-height: 60px;">
      <div class="inner bg-inherit">
          <div class="container">
              <div class="flex items-stretch justify-center relative">
                  <div class="flex items-center">
                      <a class="lg:hidden mburger mburger--collapse leading-none rtl:ml-4 ltr:mr-4" href="#mobile-menu" aria-label="Open-menu">
                        <i class="sicon-menu text-primary text-2xl"></i>
                      </a>
                     
                      <custom-main-menu></custom-main-menu>
                  </div>
                  
              </div>
          </div>
      </div>
  </div>
</header>
{% if store.scope %}
    <salla-scopes selection="{{ store.scope.display_as == 'popup' ? 'mandatory' : 'optional' }}"></salla-scopes>
{% endif %}

<script>
// Language dropdown functionality
function toggleLanguageDropdown() {
    const dropdown = document.getElementById('language-dropdown');
    if (dropdown) {
        dropdown.classList.toggle('hidden');
    }
}

document.addEventListener('DOMContentLoaded', function() {
    const dropdown = document.getElementById('language-dropdown');
    
    if (dropdown) {
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            const languageIcon = document.querySelector('img[alt="Language"]');
            if (!languageIcon.contains(e.target) && !dropdown.contains(e.target)) {
                dropdown.classList.add('hidden');
            }
        });
        
        // Close dropdown on escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                dropdown.classList.add('hidden');
            }
        });
    }
});

function changeLanguage(languageCode) {
    // Use Salla's language change API
    if (window.salla && window.salla.language) {
        window.salla.language.change(languageCode);
    } else {
        // Fallback: redirect to the language-specific URL
        const currentUrl = window.location.href;
        const baseUrl = currentUrl.split('?')[0];
        window.location.href = baseUrl + '?lang=' + languageCode;
    }
    
    // Close dropdown
    document.getElementById('language-dropdown').classList.add('hidden');
}
</script>
