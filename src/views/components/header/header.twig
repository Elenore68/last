{#
| Variable         | Type    | Description                     |
|------------------|---------|---------------------------------|
| cart             | object  |                                 |
| cart.items_count | int     |                                 |
| cart.total       | string  | Formatted total ex: "١٠٠ ر.س"   |
#}
{% set important_links = theme.settings.get('important_links') %}
<header class="store-header">
  {# Top Nav #}
  <div class="top-navbar text-white" style="background-color: #000000;">
    <div class="container flex justify-between items-center py-2">
     

      {# Left side - Cart and Profile #}
      <div class="flex items-center gap-3">
          {# Cart icon #}
          <a href="{{ store.url }}/cart" 
             class="cart-icon text-white hover:opacity-80 transition-opacity" 
             style="
               cursor: pointer;
               display: flex;
               align-items: center;
               justify-content: center;
               width: 40px;
               height: 40px;
               border-radius: 50%;
               background: transparent;
               border: none;
               transition: all 0.3s ease;
               text-decoration: none;
             ">
            <img src="{{ 'images/icons/bitcoin-icons_cart-outline.png'|asset }}" 
                 alt="Cart" 
                 style="
                   width: 20px;
                   height: 20px;
                 " />
          </a>
          
          {# Profile icon #}
          {% if user.type=='user' %}
            <salla-user-menu avatar-only show-header class="text-white"></salla-user-menu>
          {% else %}
              <button class="text-white hover:opacity-80 transition-opacity" 
                      aria-label="user-icon" 
                      onclick="salla.event.dispatch('login::open')"
                      style="
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        width: 40px;
                        height: 40px;
                        background: transparent;
                        border: none;
                        cursor: pointer;
                      ">
                <img src="{{ 'images/icons/iconamoon_profile-thin.svg'|asset }}" 
                     alt="Profile" 
                     style="
                       width: 20px;
                       height: 20px;
                       filter: brightness(0) invert(1);
                     " />
              </button>
          {% endif %}
      </div>
      {# Center - Logo #}
      <div class="flex-1 flex justify-center">
          <a class="navbar-brand" href="{{ store.url }}">
              <img fetchpriority="high" width="100%" height="100%" loading="eager" src="{{ 'images/logo.png'|asset }}" alt="{{ store.name }} logo" class="max-h-8">
              {% if is_page('index') %}
                <h1 class="sr-only">{{ store.name }}</h1>
              {% else %}
                <h2 class="sr-only">{{ store.name }}</h2>
              {% endif %}
          </a>
      </div>
       {# Right side - Language #}
      <div class="flex items-center">
              {% if store.settings.is_multilingual or store.settings.currencies_enabled %}
              <div class="flex items-center gap-2 cursor-pointer hover:opacity-80 transition-opacity" onclick="switchLanguage()">
                  <span class="text-white font-comfortaa text-[12px] font-normal leading-[25px]" id="language-toggle-text">
                    {{ user.language.code == 'ar' ? 'En' : 'Ar' }}
                  </span>
                  <img 
                    src="{{ 'images/icons/material-symbols-light_language.png'|asset }}" 
                    alt="Language" 
                    class="w-5 h-5"
                    data-translate-alt="header.language"
                  />
              </div>
          {% endif %}
      </div>
    </div>
  </div>

  {# Main Nav #}
  <div id="mainnav" class="main-nav-container shadow-default bg-black">
      <div class="inner bg-inherit">
          <div class="container">
              <div class="flex items-stretch justify-center relative">
                  <div class="flex items-center">
                      <a class="lg:hidden mburger mburger--collapse leading-none rtl:ml-4 ltr:mr-4" href="#mobile-menu" aria-label="Open-menu">
                        <i class="sicon-menu text-primary text-2xl"></i>
                      </a>
                     
                      <custom-main-menu></custom-main-menu>
                  </div>
                  
              </div>
          </div>
      </div>
  </div>
</header>
{% if store.scope %}
    <salla-scopes selection="{{ store.scope.display_as == 'popup' ? 'mandatory' : 'optional' }}"></salla-scopes>
{% endif %}

<script>
// دالة محسنة لتبديل اللغة
function switchLanguage() {
  const newLang = salla.config.get('user.language.code') === 'ar' ? 'en' : 'ar';
  
  // تحديث اللغة دون إعادة تحميل الصفحة
  salla.lang.change(newLang).then(() => {
    // إعادة تحميل المكونات الديناميكية
    salla.event.dispatch('language::changed', newLang);
    
    // تحديث نص تبديل اللغة
    const languageToggleText = document.getElementById('language-toggle-text');
    if (languageToggleText) {
      languageToggleText.textContent = newLang === 'ar' ? 'En' : 'Ar';
    }
  });
}

// تحديث النصوص عند تغيير اللغة
document.addEventListener('language::changed', function(event) {
  // إعادة تحميل مكون القائمة
  const menuElement = document.querySelector('custom-main-menu');
  if (menuElement) {
    menuElement.refresh();
  }
  
  // تحديث محتوى الصفحة
  salla.helpers.updateContent();
});
</script>
