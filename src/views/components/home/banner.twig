<section class="s-block s-block--full-bg" style="display: block !important; visibility: visible !important;">
    <!-- Banner Component Working! -->

    {% if component.banner_last and component.banner_last|length > 0 %}
        {% for banner in component.banner_last %}
            <div class="relative">
                <div class="relative w-full h-auto">
                    <!-- Debug: Show what we have -->
                    {% if banner.imageAr or banner.imageEn %}
                        <!-- Arabic Image -->
                        {% if banner.imageAr %}
                        <img
                            src="{{ banner.imageAr }}"
                            alt="Arabic Banner"
                            data-lang="ar"
                            class="localized-img w-full h-auto object-cover"
                            style="display: none;"
                        />
                        {% endif %}

                        <!-- English Image -->
                        {% if banner.imageEn %}
                        <img
                            src="{{ banner.imageEn }}"
                            alt="English Banner"
                            data-lang="en"
                            class="localized-img w-full h-auto object-cover"
                            style="display: none;"
                        />
                        {% endif %}
                    {% else %}
                        <!-- Fallback if no images are configured -->
                        <div class="w-full h-64 bg-gray-200 flex items-center justify-center">
                            <p class="text-gray-500">Banner found but no images configured</p>
                        </div>
                    {% endif %}
                </div>
                
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="container text-center text-white">
                        <div class="w-full py-20">
                            <h3 class="text-4xl font-bold mb-4">{{ banner.title }}</h3>
                            <p class="text-lg">{{ banner.subtitle }}</p>
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    {% else %}
        <!-- No banner configured - show beautiful setup guide -->
        <div class="w-full bg-gradient-to-r from-blue-600 to-purple-700 text-white py-20" style="display: block !important;">
            <div class="container mx-auto px-4 text-center">
                <div class="max-w-3xl mx-auto">
                    <div class="mb-8">
                        <h1 class="text-4xl md:text-5xl font-bold mb-4">✨ Multi-Language Banner Ready!</h1>
                        <p class="text-xl md:text-2xl opacity-90">Your banner component is working perfectly!</p>
                    </div>
                    
                    <div class="bg-white/15 backdrop-blur-sm rounded-2xl p-8 mb-8">
                        <h2 class="text-2xl font-semibold mb-6">🚀 Quick Setup Guide</h2>
                        <div class="grid md:grid-cols-2 gap-6 text-left">
                            <div class="space-y-3">
                                <h3 class="font-semibold text-lg">📋 Steps:</h3>
                                <ol class="list-decimal list-inside space-y-2 text-sm">
                                    <li>Go to <strong>Salla Admin Panel</strong></li>
                                    <li>Navigate to <strong>Theme Customizer</strong></li>
                                    <li>Find the <strong>"banner"</strong> component</li>
                                    <li>Add your banner images</li>
                                    <li>Save changes</li>
                                </ol>
                            </div>
                            <div class="space-y-3">
                                <h3 class="font-semibold text-lg">🌍 Multi-Language:</h3>
                                <ul class="space-y-2 text-sm">
                                    <li>• <strong>Arabic Image:</strong> "الصورة بالعربي"</li>
                                    <li>• <strong>English Image:</strong> "الصورة بالانجليزي"</li>
                                    <li>• <strong>Auto-switching</strong> based on language</li>
                                    <li>• <strong>Instant updates</strong> when toggling</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <p class="text-lg mb-4">🎯 <strong>Everything is ready!</strong> Just add your images.</p>
                        <p class="text-sm opacity-75">The banner will automatically appear here once configured.</p>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
</section>

<script>
  console.log('✅ Banner component loaded successfully');
  
  // Function to update banner images based on language
  function updateBannerImages(forcedLang = null) {
    // Get language from multiple sources, prioritizing forced language
    let lang = forcedLang;
    
    if (!lang) {
      // Try to get current language from various sources
      lang = document.documentElement.lang ||
             document.querySelector('html').getAttribute('lang') ||
             localStorage.getItem('currentLanguage') ||
             '{{ user.language.code }}' ||
             navigator.language.slice(0, 2) ||
             'ar';
    }

    console.log('Banner: Updating images for language:', lang);
    console.log('Banner: Available images:', document.querySelectorAll('.localized-img').length);

    // Show only the image that matches the current language
    let imageFound = false;
    document.querySelectorAll('.localized-img').forEach((img) => {
      console.log('Banner: Checking image with data-lang:', img.dataset.lang);
      if (img.dataset.lang === lang) {
        img.style.display = 'block';
        img.classList.remove('hidden');
        imageFound = true;
        console.log('Banner: ✅ Showing', lang, 'image');
      } else {
        img.style.display = 'none';
        img.classList.add('hidden');
        console.log('Banner: ❌ Hiding', img.dataset.lang, 'image');
      }
    });
    
    if (!imageFound) {
      console.warn('Banner: No image found for language:', lang);
    }
    
    // Store current language for future reference
    localStorage.setItem('currentLanguage', lang);
  }

  // Update images on page load
  document.addEventListener('DOMContentLoaded', function() {
    updateBannerImages();
  });

  // Listen for language changes from header
  document.addEventListener('languageChanged', function(event) {
    console.log('Banner: Language changed event received:', event.detail);
    const newLang = event.detail.to || event.detail.language;
    console.log('Banner: Switching to language:', newLang);
    updateBannerImages(newLang);
  });

  // Also listen for Salla language change events
  if (window.salla && window.salla.event) {
    window.salla.event.on('language::changed', function(data) {
      console.log('Banner: Salla language changed:', data);
      updateBannerImages();
    });
  }

  // Fallback: Check for language changes periodically
  let currentLang = '{{ user.language.code }}' || 'ar';
  setInterval(() => {
    const newLang = document.documentElement.lang || 
                   document.querySelector('html').getAttribute('lang') || 
                   '{{ user.language.code }}' || 'ar';
    if (newLang !== currentLang) {
      console.log('Banner: Language changed from', currentLang, 'to', newLang);
      currentLang = newLang;
      updateBannerImages();
    }
  }, 1000);

  // Initial call
  updateBannerImages();
</script>
